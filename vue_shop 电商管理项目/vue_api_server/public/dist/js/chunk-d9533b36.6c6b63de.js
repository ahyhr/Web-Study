(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d9533b36"],{"1d04":function(e,t,r){"use strict";r.d(t,"f",(function(){return n})),r.d(t,"a",(function(){return s})),r.d(t,"g",(function(){return i})),r.d(t,"d",(function(){return o})),r.d(t,"c",(function(){return l})),r.d(t,"h",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"e",(function(){return d}));var a=r("1bab");function n(){return Object(a["a"])({url:"roles"})}function s(e){return Object(a["a"])({url:"roles",method:"post",data:e})}function i(e){return Object(a["a"])({url:"roles/"+e})}function o(e,t,r){return Object(a["a"])({url:"roles/"+e,method:"put",data:{roleName:t,roleDesc:r}})}function l(e){return Object(a["a"])({url:"roles/"+e,method:"delete"})}function c(e,t){return Object(a["a"])({url:"roles/"+e+"/rights/"+t,method:"delete"})}function u(e,t){return Object(a["a"])({url:"roles/"+e+"/rights",method:"post",data:{rids:t}})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"list";return Object(a["a"])({url:"rights/"+e})}},"29f2":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"roles"},[r("breadcrumb",{attrs:{titles:["权限管理","角色列表"]}}),r("el-card",{staticClass:"box-card"},[r("el-button",{attrs:{type:"primary"},on:{click:e.addUserButton}},[e._v("添加角色")]),r("roles-table",{attrs:{roleList:e.roleList},on:{setUser:e.setUser}})],1),r("add-user-dialog",{ref:"addUserDialogRef"}),r("edit-user-dialog",{ref:"editUserDialogRef",attrs:{editUserid:e.editUserid}})],1)},n=[],s=r("99a5"),i=(r("6a61"),r("1d04")),o=r("2fbc"),l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"table"},[r("el-table",{attrs:{data:e.roleList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,(function(a,n){return r("el-row",{key:a.id,staticClass:"bdbottom",class:0===n?"bdtop":"",attrs:{type:"flex",align:"middle"}},[r("el-col",{attrs:{span:5}},[r("el-tag",{attrs:{closable:""},on:{close:function(r){return e.removeRightBuyId(t.row,a.id)}}},[e._v(e._s(a.authName))]),r("i",{staticClass:"el-icon-caret-right"})],1),r("el-col",{attrs:{span:19}},e._l(a.children,(function(a,n){return r("el-row",{key:a.id,class:0===n?"":"bdtop",attrs:{type:"flex",align:"middle"}},[r("el-col",{attrs:{span:6}},[r("el-tag",{attrs:{closable:"",type:"success"},on:{close:function(r){return e.removeRightBuyId(t.row,a.id)}}},[e._v(e._s(a.authName))]),r("i",{staticClass:"el-icon-caret-right"})],1),r("el-col",{attrs:{span:18}},e._l(a.children,(function(a){return r("el-tag",{key:a.id,attrs:{closable:"",type:"warning"},on:{close:function(r){return e.removeRightBuyId(t.row,a.id)}}},[e._v(e._s(a.authName))])})),1)],1)})),1)],1)}))}}])}),r("el-table-column",{attrs:{align:"center",type:"index"}}),r("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),r("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),r("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button-group",{staticClass:"button-group"},[r("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(r){return e.setUser(t.row.id)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(r){return e.deleteUser(t.row.id)}}},[e._v("删除")]),r("el-button",{attrs:{size:"mini",type:"warning",icon:"el-icon-setting"},on:{click:function(r){return e.showSetRightDialog(t.row)}}},[e._v("分配权限")])],1)]}}])})],1),r("set-right-dialog",{ref:"setRightDialogRef",attrs:{currentRole:e.currentRole}})],1)},c=[],u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"set-right-dialog"},[r("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},open:e.dialogOpen,close:e.dialogClose}},[r("el-tree",{ref:"treeRef",attrs:{data:e.rightsList,props:e.treeProps,"show-checkbox":"","default-expand-all":"","node-key":"id","default-checked-keys":e.defkeys}}),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.allotRights}},[e._v("确 定")])],1)],1)],1)},d=[],f=r("c420");function m(e){if(Array.isArray(e))return Object(f["a"])(e)}r("79fd"),r("45af"),r("b1fa"),r("1ec5"),r("2e6f"),r("af21"),r("0a4f");function g(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var b=r("c45c");function p(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e){return m(e)||g(e)||Object(b["a"])(e)||p()}r("a5c9"),r("2621"),r("6afd");var v={name:"setRightDialog",props:{currentRole:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:!1,rightsList:[],treeProps:{children:"children",label:"authName"},defkeys:[]}},methods:{allotRights:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=[].concat(h(e.$refs.treeRef.getCheckedKeys()),h(e.$refs.treeRef.getHalfCheckedKeys())),a=r.join(","),t.next=4,Object(i["b"])(e.currentRole.id,a);case 4:if(n=t.sent,s=n.data,200===s.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("分配权限失败"));case 8:e.$message.success("分配成功"),e.$parent.$parent.$parent.getRoleList(),e.dialogVisible=!1;case 11:case"end":return t.stop()}}),t)})))()},dialogOpen:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["e"])("tree");case 2:if(r=t.sent,a=r.data,200===a.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取权限列表失败"));case 6:e.rightsList=a.data,e.getLeafKeys(e.currentRole,e.defkeys);case 8:case"end":return t.stop()}}),t)})))()},dialogClose:function(){this.defkeys=[]},getLeafKeys:function(e,t){var r=this;if(!e.children)return t.push(e.id);e.children.forEach((function(e){r.getLeafKeys(e,t)}))}}},R=v,w=r("4ac2"),y=Object(w["a"])(R,u,d,!1,null,"a044eccc",null),x=y.exports,U={name:"RolesTable",data:function(){return{currentRole:{}}},props:{roleList:{type:Array,default:function(){return[]}}},methods:{removeRightBuyId:function(e,t){var r=this;this.$confirm("是否删除该权限?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["h"])(e.id,t);case 2:if(n=a.sent,s=n.data,200===s.meta.status){a.next=6;break}return a.abrupt("return",r.$message.error("删除失败"));case 6:r.$message.success("删除成功!"),e.children=s.data;case 8:case"end":return a.stop()}}),a)})))).catch((function(){r.$message("已取消删除")}))},setUser:function(e){this.$emit("setUser",e)},deleteUser:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$confirm("是否删除该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(i["c"])(e);case 2:if(a=r.sent,n=a.data,200===n.meta.status){r.next=6;break}return r.abrupt("return",t.$message.error("删除失败"));case 6:t.$message.success("删除成功"),t.$parent.$parent.getRoleList();case 8:case"end":return r.stop()}}),r)})))).catch((function(){t.$message("已取消删除")}));case 1:case"end":return r.stop()}}),r)})))()},showSetRightDialog:function(e){this.currentRole=e,this.$refs.setRightDialogRef.dialogVisible=!0}},components:{setRightDialog:x}},k=U,$=(r("d884"),Object(w["a"])(k,l,c,!1,null,"bf45a4ec",null)),D=$.exports,O=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"add-user-dialog"},[r("el-dialog",{attrs:{title:"添加角色",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.DialogClosed}},[r("el-form",{ref:"addUserFromRef",attrs:{model:e.addUserFrom,rules:e.FromRules,"label-width":"90px","label-position":"left","status-icon":""}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.addUserFrom.roleName,callback:function(t){e.$set(e.addUserFrom,"roleName",t)},expression:"addUserFrom.roleName"}})],1),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{model:{value:e.addUserFrom.roleDesc,callback:function(t){e.$set(e.addUserFrom,"roleDesc",t)},expression:"addUserFrom.roleDesc"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1)],1)},j=[],_={name:"addUserDialog",data:function(){return{dialogVisible:!1,addUserFrom:{roleName:"测试1",roleDesc:"人员"},FromRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"blur"}]}}},methods:{addUser:function(){var e=this;this.$refs.addUserFromRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(i["a"])(e.addUserFrom);case 4:if(a=t.sent,n=a.data,201===n.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("创建失败"));case 8:e.$message.success(n.meta.msg),e.$parent.getRoleList(),e.dialogVisible=!1;case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},DialogClosed:function(){this.$refs.addUserFromRef.resetFields()}}},F=_,C=Object(w["a"])(F,O,j,!1,null,null,null),N=C.exports,L=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"edit-user-dialog"},[r("el-dialog",{attrs:{title:"编辑角色",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.DialogClosed,open:e.DialogOpen}},[r("el-form",{ref:"editUserDialog",attrs:{model:e.editUserFrom,rules:e.FromRules,"label-width":"90px","label-position":"left","status-icon":""}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.editUserFrom.roleName,callback:function(t){e.$set(e.editUserFrom,"roleName",t)},expression:"editUserFrom.roleName"}})],1),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{model:{value:e.editUserFrom.roleDesc,callback:function(t){e.$set(e.editUserFrom,"roleDesc",t)},expression:"editUserFrom.roleDesc"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editUser}},[e._v("确 定")])],1)],1)],1)},V=[],E=(r("e1d4"),{name:"editUserDialog",props:{editUserid:Number},data:function(){return{dialogVisible:!1,editUserFrom:{roleName:"",roleDesc:""},FromRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"blur"}]}}},methods:{editUser:function(){var e=this;this.$refs.editUserDialog.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(i["d"])(e.editUserid,e.editUserFrom.roleName,e.editUserFrom.roleDesc);case 4:if(a=t.sent,n=a.data,200===n.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("修改失败"));case 8:e.$message.success("修改成功"),e.$parent.getRoleList(),e.dialogVisible=!1;case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},DialogOpen:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["g"])(e.editUserid);case 2:if(r=t.sent,a=r.data,200===a.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("查询角色失败"));case 6:e.editUserFrom=a.data;case 7:case"end":return t.stop()}}),t)})))()},DialogClosed:function(){}}}),B=E,T=Object(w["a"])(B,L,V,!1,null,null,null),S=T.exports,A={name:"Roles",data:function(){return{roleList:[],editUserid:null}},components:{Breadcrumb:o["a"],RolesTable:D,AddUserDialog:N,EditUserDialog:S},created:function(){this.getRoleList()},methods:{setUser:function(e){this.editUserid=e,this.$refs.editUserDialogRef.dialogVisible=!0},addUserButton:function(){this.$refs.addUserDialogRef.dialogVisible=!0},getRoleList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(i["f"])();case 2:if(r=t.sent,a=r.data,200===a.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取权限列表失败"));case 6:e.roleList=a.data;case 7:case"end":return t.stop()}}),t)})))()}}},I=A,K=(r("932b"),Object(w["a"])(I,a,n,!1,null,"7cdc35a0",null));t["default"]=K.exports},"634d":function(e,t,r){},"6afd":function(e,t,r){var a=r("b074"),n=r("99f2"),s=r("d393"),i=r("429f");for(var o in n){var l=a[o],c=l&&l.prototype;if(c&&c.forEach!==s)try{i(c,"forEach",s)}catch(u){c.forEach=s}}},"932b":function(e,t,r){"use strict";r("634d")},a5c9:function(e,t,r){"use strict";var a=r("e450"),n=r("d50e"),s=r("99f6"),i=r("0f4e"),o=r("eb35"),l=r("a4fc"),c=r("f342"),u=r("9f0d"),d=r("529c"),f=r("9bc6"),m=r("acb9"),g=f("isConcatSpreadable"),b=9007199254740991,p="Maximum allowed index exceeded",h=m>=51||!n((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),v=d("concat"),R=function(e){if(!i(e))return!1;var t=e[g];return void 0!==t?!!t:s(e)},w=!h||!v;a({target:"Array",proto:!0,forced:w},{concat:function(e){var t,r,a,n,s,i=o(this),d=u(i,0),f=0;for(t=-1,a=arguments.length;t<a;t++)if(s=-1===t?i:arguments[t],R(s)){if(n=l(s.length),f+n>b)throw TypeError(p);for(r=0;r<n;r++,f++)r in s&&c(d,f,s[r])}else{if(f>=b)throw TypeError(p);c(d,f++,s)}return d.length=f,d}})},bb11:function(e,t,r){},d393:function(e,t,r){"use strict";var a=r("a3e7").forEach,n=r("104f"),s=n("forEach");e.exports=s?[].forEach:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}},d884:function(e,t,r){"use strict";r("bb11")}}]);